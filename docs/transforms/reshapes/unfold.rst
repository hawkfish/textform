Unfold: Rotate one field to many
================================

.. py:currentmodule:: txf

.. py:class:: Unfold(source, inputs, outputs)

    The ``Unfold`` transform unfolds (pivots) a set of fields.
    Simple unfolding consists of rotating a single input fields into multiple output fields.
    This can be generalised to multiple input fields where the output fields
    are broken up into equal-sized groups, each of which is generated from one of the input fields.
    ``Unfold`` is the inverse of :py:class:`Fold`.

    .. py:attribute:: source
        :type: Transform

        The input pipeline.

    .. py:attribute:: inputs
        :type: tuple(str)

        The list of fields to be unfolded.
        They will be dropped from the output, so use :py:class:`Copy` to preserve them.
        Each input field contains the values for an entire output group.

    .. py:attribute:: outputs
        :type: tuple(str)

        The output fields receiving the unfolded fields.
        The output fields are broken into equal-sized groups, one per input field.
        The number of *inputs* must be an even multiple of the number of *outputs*.
        They cannot overwrite existing fields, so use :py:class:`Drop` to remove unwanted fields.

Limitations
^^^^^^^^^^^
The current implementation assumes that the unfolded values are contiguous.
That is, all the input rows for a single output row will arrive sequentially and in order.
This is the order generated by :py:class:`Fold`, so it is suggested that for now ``Unfold``
only be used to undo the actions of :py:class:`Fold`.

Usage
^^^^^

.. code-block:: python

   Unfold(p, ('Year', 'Sales',), ('Sales 1992', 'Sales 1993', 'Sales 1994',))
   Unfold(p, ('Year', 'Sales', 'Profit',), ('Sales 1992', 'Sales 1993', 'Sales 1994', 'Profit 1992', 'Profit 1993', 'Profit 1994',))
