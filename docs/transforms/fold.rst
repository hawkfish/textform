Fold
====

.. py:currentmodule:: textform

.. py:class:: Fold(pipeline, inputs, outputs, tags=None)

    The ``Fold`` transform folds (unpivots) a set of columns.

    Simple folding consists of rotating multiple input columns into a single output column
    and a column of tags containing the original input column names.

    This can be generalised to multiple output columns where the input columns
    are broken up into equal-sized groups, each of which is mapped to one of the output columns.
    In the latter case, the tags can be supplied by the caller or generated by concatenating the column names.

    .. py:attribute:: pipeline
        :type: Transform

        The input pipeline (required).

    .. py:attribute:: inputs
        :type: tuple(str)

        The list of columns to be folded.
        They will be dropped from the output, so use :py:class:`Copy` to preserve them.

    .. py:attribute:: outputs
        :type: tuple(str)

        The the output columns receiving the tags and the folded columns.
        The first output contains the tags and the remaining columns contain the group values.
        The number of *inputs* must be a multiple of the number of groups.
        They cannot overwrite existing columns, so use :py:class:`Drop` to remove unwanted columns.

    .. py:attribute:: tags
        :type: tuple(str)

        The optional tags for the output. It will be generated if not provided.

Usage
^^^^^

.. code-block:: python

   Fold(p, ('Sales 1992', 'Sales 1993', 'Sales 1994',), ('Year', 'Sales',))
   Fold(p, ('Sales 1992', 'Sales 1993', 'Sales 1994', 'Profit 1992', 'Profit 1993', 'Profit 1994',), ('Year', 'Sales', 'Profit',))
